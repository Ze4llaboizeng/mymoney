<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuromi Money Pro</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Chakra+Petch:wght@400;600&family=VT323&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <header class="app-header">
        <div class="d-flex align-items-center gap-2">
            <div class="bg-dark text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                <i class="bi bi-skull-fill fs-5"></i>
            </div>
            <div style="line-height: 1.1;">
                <h5 class="fw-bold m-0" style="color: var(--k-dark);">Kuromi Pro</h5>
                <small class="text-muted" style="font-size: 0.7rem;">MY WALLET</small>
            </div>
        </div>
        <button class="btn btn-sm btn-outline-danger rounded-pill fw-bold" style="padding: 5px 12px; font-size: 0.75rem;" data-bs-toggle="modal" data-bs-target="#newMonthModal">
            <i class="bi bi-arrow-repeat"></i> Reset
        </button>
    </header>

    <div class="container px-3">
        <div class="tab-content" id="mainTabContent">
            
            <div class="tab-pane fade show active" id="content-dash">
                <div class="k-card text-center p-4 text-white position-relative mt-2" 
                     style="background: linear-gradient(135deg, #1a1a1a 0%, #4a148c 100%); border: none;">
                    <div style="position: absolute; top: 15px; right: 15px; opacity: 0.3;">
                        <i class="bi bi-stars fs-1"></i>
                    </div>
                    <small class="text-white-50 text-uppercase letter-spacing-2 mb-1">Total Balance</small>
                    <h1 class="display-4 fw-bold mb-0">‡∏ø{{ "{:,.2f}".format(balance) }}</h1>
                    
                    <div class="row mt-3 g-2">
                        <div class="col-6">
                            <div class="bg-white bg-opacity-10 rounded-3 p-1">
                                <small class="text-success fw-bold"><i class="bi bi-arrow-down"></i> ‡∏£‡∏±‡∏ö {{ "{:,.0f}".format(income) }}</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="bg-white bg-opacity-10 rounded-3 p-1">
                                <small class="text-danger fw-bold"><i class="bi bi-arrow-up"></i> ‡∏à‡πà‡∏≤‡∏¢ {{ "{:,.0f}".format(expense) }}</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="k-card p-3">
                    <form action="/add" method="POST">
                        <div class="row g-2 mb-2">
                            <div class="col-5">
                                <select name="type" class="form-select rounded-pill fw-bold text-center" id="typeSelect" onchange="toggleCategories('categorySelect')">
                                    <option value="expense">üî• ‡∏à‡πà‡∏≤‡∏¢</option>
                                    <option value="income">‚ú® ‡∏£‡∏±‡∏ö</option>
                                </select>
                            </div>
                            <div class="col-7">
                                <select name="category" class="form-select rounded-pill" id="categorySelect"></select>
                            </div>
                        </div>
                        <div class="input-group mb-2">
                            <span class="input-group-text bg-white border-0 fw-bold fs-5 text-dark">‡∏ø</span>
                            <input type="number" step="0.01" name="amount" class="form-control border-0 bg-light rounded-3 fw-bold fs-4" placeholder="0.00" required>
                        </div>
                        <input type="text" name="note" class="form-control rounded-pill mb-3 text-center border-0 bg-light" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥...">
                        <button type="submit" class="btn btn-kuromi w-100 shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                    </form>
                </div>

                <div class="d-flex justify-content-between align-items-center mt-4 mb-2 px-1">
                    <h6 class="fw-bold m-0 text-muted">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h6>
                    <button class="btn btn-sm btn-dark rounded-pill px-3" data-bs-toggle="modal" data-bs-target="#recapModal">
                        <i class="bi bi-receipt"></i> ‡∏™‡∏£‡∏∏‡∏õ
                    </button>
                </div>

                <div class="pb-3">
                {% for t in transactions %}
                <div class="k-card p-3 d-flex justify-content-between align-items-center mb-2" 
                     style="border-left: 5px solid {{ '#e91e63' if t.type == 'expense' else '#4caf50' }}; border-radius: 16px;">
                    <div style="flex: 1; padding-right: 10px; overflow: hidden;">
                        <div class="fw-bold text-truncate" style="font-size: 1rem;">{{ t.note }}</div>
                        <small class="text-muted d-block text-truncate" style="font-size: 0.75rem;">
                            {{ t.date }} <span class="badge bg-light text-dark border ms-1">{{ t.category }}</span>
                        </small>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <span class="{{ 'text-success' if t.type == 'income' else 'text-danger' }} fw-bold fs-5 text-nowrap">
                            {{ '+' if t.type == 'income' else '-' }}{{ "{:,.0f}".format(t.amount) }}
                        </span>
                        <div class="dropdown">
                            <button class="btn btn-light rounded-circle text-secondary d-flex align-items-center justify-content-center shadow-sm" 
                                    style="width: 32px; height: 32px;" type="button" data-bs-toggle="dropdown">
                                <i class="bi bi-three-dots-vertical"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end shadow border-0 rounded-4 p-2">
                                <li><a class="dropdown-item rounded-3 py-2" href="#" onclick='openEditModal({{ t | tojson }})'><i class="bi bi-pencil me-2 text-warning"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a></li>
                                <li><a class="dropdown-item rounded-3 py-2 text-danger" href="/delete/{{ t.id }}" onclick="return confirm('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏≠?')"><i class="bi bi-trash me-2"></i> ‡∏•‡∏ö</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                {% endfor %}
                </div>
            </div>

            <div class="tab-pane fade retro-wrapper" id="content-salary">
                <div style="width: 100%;">
                    <div class="d-flex justify-content-center gap-2 mb-3 mt-2">
                        <button class="btn btn-sm btn-dark rounded-pill px-4 flex-grow-1" onclick="savePreset()"><i class="bi bi-floppy"></i> Save</button>
                        <button class="btn btn-sm btn-warning rounded-pill px-4 flex-grow-1" onclick="capture('salary-slip-node', 'SalarySlip')"><i class="bi bi-camera"></i> Image</button>
                    </div>

                    <div class="receipt-paper mx-auto" id="salary-slip-node">
                        <div class="jagged-top"></div>
                        <div style="text-align: center;">
                            <div class="retro-brand">PAYROLL SLIP</div>
                        </div>
                        <div class="text-center small opacity-50 mb-3"><span id="currentDate"></span> / MONTHLY 2025</div>
                        <div class="double-divider"></div>

                        <div class="row-group-title">1. ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (INCOME)</div>
                        <div class="retro-row"><span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Base)</span> <input type="text" id="salary" class="retro-input" value="{{ salary_preset.get('salary', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏á‡∏ä‡∏µ‡∏û (C.O.L.)</span> <input type="text" id="col" class="retro-input" value="{{ salary_preset.get('col', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö (Level)</span> <input type="text" id="level_pay" class="retro-input" value="{{ salary_preset.get('level_pay', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ç‡∏¢‡∏±‡∏ô (Diligence)</span> <input type="text" id="diligence" class="retro-input" value="{{ salary_preset.get('diligence', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (Food)</span> <input type="text" id="food" class="retro-input" value="{{ salary_preset.get('food', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Other)</span> <input type="text" id="other" class="retro-input" value="{{ salary_preset.get('other', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>

                        <div class="divider"></div>
                        <div class="row-group-title">2. ‡∏•‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (OVERTIME)</div>
                        <div style="font-size: 0.8rem; text-align: right; margin-bottom:5px;">RATE: <span id="hr_rate">0.00</span> B/Hr</div>
                        <div class="retro-row"><span>OT x1.5 (‡∏ä‡∏°.)</span> <div style="display:flex;"><input type="text" id="ot15_hr" class="retro-input hrs-input" value="{{ salary_preset.get('ot15_hr', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"><span class="amt-text" id="ot15_amt">0.00</span></div></div>
                        <div class="retro-row"><span>OT x1.3 (‡∏ä‡∏°.)</span> <div style="display:flex;"><input type="text" id="ot13_hr" class="retro-input hrs-input" value="{{ salary_preset.get('ot13_hr', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"><span class="amt-text" id="ot13_amt">0.00</span></div></div>
                        <div class="retro-row"><span>OT x3.0 (‡∏ä‡∏°.)</span> <div style="display:flex;"><input type="text" id="ot30_hr" class="retro-input hrs-input" value="{{ salary_preset.get('ot30_hr', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"><span class="amt-text" id="ot30_amt">0.00</span></div></div>
                        <div class="retro-row"><span>‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£ OT (20‡∏ö.)</span><span class="amt-text" id="ot_food_amt">0.00</span></div>

                        <div class="retro-row fw-bold" style="margin-top:10px; border-top: 1px dashed black; padding-top:5px;"><span>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (GROSS)</span><span class="amt-text" id="total_income">0.00</span></div>

                        <div class="row-group-title">3. ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏Å (DEDUCTION)</div>
                        <div class="retro-row"><span>‡∏†‡∏≤‡∏©‡∏µ (Tax)</span> <input type="text" id="d_tax" class="retro-input deduct" value="{{ salary_preset.get('d_tax', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° (SSO)</span> <input type="text" id="d_sso" class="retro-input deduct" value="{{ salary_preset.get('d_sso', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô/‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</span> <input type="text" id="d_fund" class="retro-input deduct" value="{{ salary_preset.get('d_fund', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row" style="color: #444;"><span>‡∏£‡∏ß‡∏°‡∏´‡∏±‡∏Å (Total Deduct)</span><span class="amt-text" id="total_deduct">0.00</span></div>

                        <div class="double-divider"></div>
                        <div class="retro-row" style="font-weight: bold;"><span class="fs-4">NET PAY</span><span class="amt-text" style="font-size: 1.8rem;" id="net_pay">0.00</span></div>
                        <div class="divider"></div>

                        <div class="row-group-title">4. ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏à‡∏≥‡∏•‡∏≠‡∏á)</div>
                        <div class="retro-row"><span>‡∏ö‡πâ‡∏≤‡∏ô/‡∏£‡∏ñ</span> <input type="text" id="exp_1" class="retro-input expense" value="{{ salary_preset.get('exp_1', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</span> <input type="text" id="exp_2" class="retro-input expense" value="{{ salary_preset.get('exp_2', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô/‡∏ö‡∏±‡∏ï‡∏£</span> <input type="text" id="exp_3" class="retro-input expense" value="{{ salary_preset.get('exp_3', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>
                        <div class="retro-row"><span>‡∏Å‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà/‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span> <input type="text" id="exp_4" class="retro-input expense" value="{{ salary_preset.get('exp_4', '') }}" onblur="solve(this)" onkeydown="handleEnter(event,this)" oninput="calc()"></div>

                        <div style="border: 2px solid var(--ink-color); padding: 10px; margin-top: 20px;">
                            <div style="text-align: center; font-weight: bold; margin-bottom: 8px;">[ GRAPHICAL REPORT ]</div>
                            <div style="margin-bottom: 8px;">
                                <div style="font-size: 0.8rem; display: flex; justify-content: space-between;"><span>INCOME</span><span>100%</span></div>
                                <div class="bar-container"><div class="bar-fill" style="width: 100%; opacity: 0.3; background: #000;"></div></div>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <div style="font-size: 0.8rem; display: flex; justify-content: space-between;"><span>TOTAL EXPENSE</span><span id="exp_pct">0%</span></div>
                                <div class="bar-container"><div class="bar-fill expense" id="bar_expense"></div></div>
                            </div>
                            <div>
                                <div style="font-size: 0.8rem; display: flex; justify-content: space-between;"><span>BALANCE</span><span id="bal_pct">0%</span></div>
                                <div class="bar-container"><div class="bar-fill balance" id="bar_balance"></div></div>
                            </div>
                        </div>

                        <div class="retro-row" style="margin-top: 20px; font-weight: bold;"><span>CASH BALANCE</span><span class="amt-text" style="font-size: 1.5rem; border: 2px solid black; padding: 2px 5px;" id="sim_balance">0.00</span></div>
                        <div class="barcode"></div>
                        <div class="jagged-bottom"></div>
                    </div>

                    <div class="mt-4 px-1 pb-4">
                        <form action="/add" method="POST" id="salaryForm">
                           <input type="hidden" name="type" value="income">
                           <input type="hidden" name="category" value="‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">
                           <input type="hidden" name="note" value="‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥">
                           <input type="hidden" name="amount" id="final_salary_amount">
                           <button type="button" onclick="submitSalary()" class="btn btn-kuromi w-100 py-3 shadow"><i class="bi bi-check-circle"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏≠‡∏õ</button>
                       </form>
                   </div>
                </div>
            </div>

            <div class="tab-pane fade" id="content-saving">
                <div class="d-grid mb-3 mt-2">
                    <button class="btn btn-outline-dark border-dashed rounded-4 py-3" data-bs-toggle="collapse" data-bs-target="#addGoalForm">
                        <i class="bi bi-plus-circle-fill fs-3 d-block text-danger"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
                <div class="collapse mb-3" id="addGoalForm">
                    <div class="k-card p-3 bg-light border-0">
                        <form action="/add_saving_goal" method="POST">
                            <input type="text" name="name" class="form-control rounded-pill mb-2 text-center" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢..." required>
                            <input type="number" name="target" class="form-control rounded-pill mb-2 text-center" placeholder="‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)" required>
                            <button type="submit" class="btn btn-danger rounded-pill w-100">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏¢</button>
                        </form>
                    </div>
                </div>
                {% for goal in savings %}
                <div class="piggy-jar position-relative mb-4">
                    <a href="/delete_saving/{{ goal.id }}" class="piggy-delete" onclick="return confirm('‡∏à‡∏∞‡∏ó‡∏∏‡∏ö‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏•‡∏¢‡∏´‡∏£‡∏≠?')"><i class="bi bi-trash-fill"></i></a>
                    <div class="text-center mb-2 text-white">
                        <i class="bi bi-piggy-bank-fill display-3"></i>
                        <h4 class="fw-bold m-0 mt-1">{{ goal.name }}</h4>
                        <div class="badge bg-white text-danger rounded-pill px-3 mt-1 shadow-sm">{{ "{:,.0f}".format(goal.current) }} / {{ "{:,.0f}".format(goal.target) }}</div>
                    </div>
                    {% set pct = (goal.current / goal.target * 100) | round(1) %}
                    <div class="progress border border-2 border-white" style="height: 15px; border-radius: 10px; background: rgba(255,255,255,0.3);"><div class="progress-bar bg-white" style="width: {{ pct }}%;"></div></div>
                    <form action="/update_saving" method="POST" class="mt-3 bg-white p-2 rounded-pill shadow-sm d-flex gap-2">
                        <input type="hidden" name="goal_id" value="{{ goal.id }}">
                        <input type="number" name="amount" class="form-control border-0 bg-transparent fw-bold ps-3" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô" required style="box-shadow: none;">
                        <button type="submit" name="action" value="deposit" class="btn btn-danger rounded-circle" style="width: 40px; height: 40px;"><i class="bi bi-plus-lg"></i></button>
                        <button type="submit" name="action" value="withdraw" class="btn btn-outline-danger rounded-circle border-0" style="width: 40px; height: 40px;"><i class="bi bi-dash-lg"></i></button>
                    </form>
                </div>
                {% else %}
                <div class="text-center py-5 text-muted opacity-50"><i class="bi bi-piggy-bank display-1"></i><p class="mt-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô</p></div>
                {% endfor %}
            </div>

            <div class="tab-pane fade" id="content-worth">
                <div class="k-card p-4 text-center mt-2">
                    <h3 class="fw-bold mb-1"><i class="bi bi-magic text-purple"></i> ‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡∏ß‡∏¥‡πÄ‡∏®‡∏©</h3>
                    <p class="text-muted small mb-4">"Time Cost of Money" Calculator</p>
                    
                    <div class="mb-3 text-start">
                        <label class="fw-bold small ms-2 text-muted">‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ</label>
                        <input type="text" id="w_name" class="form-control rounded-pill bg-light border-0" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                    </div>
                    <div class="mb-3 text-start">
                        <label class="fw-bold small ms-2 text-muted">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                        <input type="number" id="w_price" class="form-control border-0 bg-light fw-bold display-1 text-center py-3" style="font-size: 2.5rem; border-radius: 20px;" placeholder="0">
                    </div>

                    <div class="bg-light rounded-4 p-3 mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small fw-bold"><i class="bi bi-gear"></i> ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏ä‡∏°.</span>
                            <span class="badge bg-secondary rounded-pill" id="display_wage">‡∏ø{{ settings.hourly_wage }}</span>
                        </div>
                        <div class="collapse show" id="wageSettings">
                            <div class="d-flex gap-2">
                                <input type="number" id="w_hourly" class="form-control form-control-sm text-center rounded-pill" value="{{ settings.hourly_wage }}" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á...">
                                <form action="/update_settings" method="POST" id="wageForm" class="flex-shrink-0">
                                    <input type="hidden" name="hourly_wage" id="hidden_wage">
                                    <button type="submit" class="btn btn-sm btn-dark rounded-pill px-3">Save</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <button onclick="calcWorth()" class="btn btn-kuromi w-100 rounded-pill fw-bold py-3 shadow fs-5">
                        üîÆ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤
                    </button>

                    <div id="w_result" class="d-none mt-4 p-3 rounded-4 bg-white border border-2 border-dark position-relative">
                        <div id="w_badge" class="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-danger px-3 py-2 shadow">
                            WAIT
                        </div>
                        <div class="mt-3">
                            <span class="text-muted small">‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏Å‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢</span>
                            <h1 class="display-2 fw-bold mb-0" id="res_hours">0</h1>
                            <span class="text-uppercase fw-bold text-secondary">Hours of Life</span>
                        </div>
                        <hr class="my-3 border-secondary">
                        <div class="text-start">
                            <h5 class="fw-bold" id="w_verdict_title">VERDICT</h5>
                            <p class="small text-muted mb-2" id="w_verdict_desc">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥...</p>
                            <div class="alert alert-light border small text-dark mt-2">
                                <i class="bi bi-info-circle-fill text-info"></i> 
                                <span id="w_ref_text">Research Reference</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div> 
    </div>

    <nav class="bottom-nav">
        <button class="nav-btn active" data-bs-toggle="pill" data-bs-target="#content-dash"><i class="bi bi-wallet2"></i><span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button>
        <button class="nav-btn" data-bs-toggle="pill" data-bs-target="#content-salary"><i class="bi bi-receipt"></i><span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span></button>
        <button class="nav-btn" data-bs-toggle="pill" data-bs-target="#content-saving"><i class="bi bi-piggy-bank"></i><span>‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô</span></button>
        <button class="nav-btn" data-bs-toggle="pill" data-bs-target="#content-worth"><i class="bi bi-calculator"></i><span>‡∏Ñ‡∏∏‡πâ‡∏°‡πÑ‡∏´‡∏°</span></button>
    </nav>
    
    <div class="modal fade" id="editModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 rounded-4 shadow"><div class="modal-header border-0 pb-0"><h5 class="modal-title fw-bold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form action="/edit_transaction" method="POST"><input type="hidden" name="id" id="edit_id"><select name="type" id="edit_type" class="form-select rounded-pill mb-2 text-center bg-light border-0" onchange="toggleCategories('edit_category')"><option value="expense">‡∏à‡πà‡∏≤‡∏¢</option><option value="income">‡∏£‡∏±‡∏ö</option></select><select name="category" id="edit_category" class="form-select rounded-pill mb-2 bg-light border-0"></select><input type="number" step="0.01" name="amount" id="edit_amount" class="form-control fw-bold rounded-pill mb-2 text-center fs-3 border-0" required><input type="text" name="note" id="edit_note" class="form-control rounded-pill mb-3 text-center border-0 bg-light"><button type="submit" class="btn btn-kuromi w-100">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></form></div></div></div></div>
    <div class="modal fade" id="recapModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content bg-transparent border-0"><div class="receipt-paper mx-auto" style="width: 300px;" id="monthRecapNode"><div class="jagged-top"></div><div class="text-center mb-3"><div class="retro-brand">RECAP</div><div class="small opacity-50">SUMMARY REPORT</div></div><div class="fw-bold text-decoration-underline mb-1">BREAKDOWN</div>{% for cat, data in category_summary.items() %}{% if data.type == 'expense' %}<div class="retro-row" style="font-size: 1rem;"><span>{{ cat }}</span><span>{{ "{:,.2f}".format(data.amount) }}</span></div>{% endif %}{% endfor %}<div style="border-top: 2px dashed black; margin-top: 15px; padding-top: 5px;"></div><div class="retro-row fw-bold"><span>TOTAL EXP.</span><span>{{ "{:,.2f}".format(expense) }}</span></div><div class="retro-row fw-bold text-success"><span>TOTAL INC.</span><span>{{ "{:,.2f}".format(income) }}</span></div><div style="border-bottom: 3px double black; margin: 10px 0;"></div><div class="text-center"><span class="d-block small">NET BALANCE</span><span class="vt-font fw-bold fs-1">{{ "{:,.2f}".format(balance) }}</span></div><div class="text-center mt-3 small opacity-50">KEEP FIGHTING!</div><div class="jagged-bottom"></div></div><div class="text-center mt-3"><button class="btn btn-light fw-bold rounded-pill shadow" onclick="capture('monthRecapNode', 'Monthly_Recap')"><i class="bi bi-download"></i> Save Image</button></div></div></div></div>
    <div class="modal fade" id="newMonthModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 rounded-4 overflow-hidden"><div class="modal-header border-0 bg-danger text-white justify-content-center"><h5 class="modal-title fw-bold"><i class="bi bi-exclamation-triangle-fill"></i> ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏†‡∏±‡∏¢!</h5></div><div class="modal-body text-center py-4"><p class="mb-4">‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?</p><form action="/reset_month" method="POST"><button type="submit" class="btn btn-danger w-100 rounded-pill fw-bold py-2 shadow-sm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></form><button class="btn btn-light w-100 rounded-pill mt-2 text-muted" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button></div></div></div></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
